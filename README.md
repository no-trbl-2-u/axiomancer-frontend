# Axiomancer

## Game Documentation
# Axiomancer

## Who is the player?
The player is an innocent child (race decided by player) who knows nothing of the evil, the beautiful, the chaos of the world around them. They see the world through a the ignorance lens of childhood. They are a young child within a small seafaring town. In order for them to make something of themselves, they must go on their pilgrimage _(why? TBD)_. Their earliest memory is of traveling to the Labyrinth's door when their parents went on their last pilgrimage.

## What is the ultimate goal?

> The ultimate goal is for the player teach become the King's new advisor. There will be countless different ways this could play out, with many different endings.

### Childhood (Boat)
During childhood, the player must first explore the neighboring areas of his town in order to accumulate boat pieces to make a boat to travel across the sea. During this time, it's all rainbows and sunshine. It'll resemble the beginning of Kingdom Hearts a little bit.

### Childhood (Get to Labyrinth)
Once the boat is crafted the player must traverse the sea (also handled like normal exploration ie. randomized combat, finding loot, etc.) until they reach the other coast. Then they must travel inland as he hears more and more rumors that the Labyrinth's doors have opened and the King's advisor has just recently died. The more they travel inland, the more the player travels inland, the more evidence there seems to be surrounding the claims.

### Childhood into Adulthood (Inside the Labyrinth)
As the player reaches the labyrinth, he sees the rumors were true and the gargantuan doors have opened. This is almost unheard of. Only the oldest of the races remember hearing rumors that these doors were ever open.

Inside the Labyrinth, the player solves increasingly hard puzzles, battles increasingly more difficult enemies, and finds increasingly rare loot. It'll be a point and click bringing the player from one chamber to the next, over and over, each time aging them an entire year. Meanwhile, he'll still be communicating and combating enemies, Mythical Creatures, and now demons. Until finally, he reaches the end and enters through into the world's largest empire.

### Adulthood in Empire
The player, entering into an entirely alien world will have to find a way to adapt quickly. The very first combat in the city will be matching wits with a child they bump into. It's an unwinnable fight. This is when the player realized just how much more advanced this civilization is and must seek help. During this time, the player visits countless different warring factions within the empire, running errands, sparring with, spying on the neighboring factions, whatever the player decides is still morally acceptable. Each faction has a theme around a common philosophical school of thought (ie. Existentialists vs. Theists). The plan is to gain trust in a faction and for them to provide you a way into the castle. Each faction has a different idea of what's morally okay and how far are you willing to go to achieve your goals.

### Adulthood in Castle
After the player finally achieves a way into the castle, they'll have to either brute force their way to the King's chamber (Body Tactics), set traps and be stealthy (Mind Tactics), or influence guards, maids, and other thinkers with their charm (Heart Tactics). When they finally do, they're met with n-members of the King's royal circle. After besting them all in games of wit, you have finally proven yourself worthy to become the King's advisor and bring stability back to the world.

### _Multiple Endings_
The game will give the players free reign to align themselves with just about anyone. The player can befriend fellow thinkers, lesser mythical creatures, entire factions, cultists, priests, evil paladins, or even demons.

For instance fully "signing your soul over to a demon" allows for fallacy boosts, equipment, static passive (de)buffs, and if they truly give in, the player can summon the demon to fight in their place if they feel outwitted.

The catch is that you will just be that demon's puppet when you become advisor or else you'll have a fate worse than death (which is definitely and ending a player could experience).

That's just a few examples for how this can be implemented.

## What is the setting?
>(THE MOST IMPORTANT NOTE: The setting is incredibly similar to the game Mork Borg. I want everything to be festering, dreary, disease-ridden, and dystopian)

### The Empire

At the heart of the world, there is the largest empire ever built surrounded by the largest labyrinth ever built. It's a fully self-sustaining city, complete with the most advanced thinkers of the world. It's so big, there are in-fact mines in the walls, forests, and even a lake.

### The Starting Town
The Player begins their journey in a humble little sea-faring village that exists along the largest river in the world on one side, and ocean on the other side. Nobody's particularly wealthy and family is the most important thing to these people.

### Necronia (Placeholder name)
A town forever scourged in darkness, death, and unholy ideals. This is where all the cultists, evil paladins, executioners, and undead come from. There's a large black pyramid in the center of the village ozzing a green fluid down it's size like a neon green waterfall. It's larger than any other mountain in the world. This is also where the King's old advisor was from.

> (Note: _The Player will not have access to this area unless they unlock a specific ending that will add a new optional questline if achieved_)

### The Labyrinth
Filled with ladders, chutes, stairs, secret passageways, traps, mythical creatures, other thinkers on their pilgrimage, cultists, demons, dead ends, and various trials. The inside will have seemingly impossible rooms, like a room where everything is white and a single, very large tree is growing upside-down, with its roots in the ceiling.

> (NOTE: _I want the labyrinth to look and behave like the book "Maze - Solve the World's Most Challenging Puzzle (1985)_")

#### Other Notable places:
* A Mountain range of Volcanos connected via underground cave systems
* Cityscape (streets)
* Cityscape (courtroom)
* A Swamp city inhabited by anthropomorphic Cockroaches.
* A series of Islands

## Who are the enemies? (Just the beginning of the compendium)
### Forest Spirits (In forest north of the starting town)
Simple little sprites that like to stir up chaos by constantly straw-manning people into believing all types of things. This'll be the player's introduction to the combat in the game.

### Starting Forest Legendary Elk
This Legendary Elk is met at the center of the forest and if bested in combat, will share his secret to the forest. After being bested in battle, the Elk will ask a simple thought experiment (ie. Trolley problem) and will teach the player either a fallacy or a paradox. Either way, the player accumulates their first ever "Special Atk". The Elk will then request the player travels further north to some loggers destroying the forest and to use their newly-found power to drive out the loggers. If the player succeeds, the Elk promises to assist the player in acquiring the lumber needed for the boat.

### Demons (Introduced after player dies in the city)
Demons are a special entity that offers two different boons:
1) An Upgrade (whether that's equipment, your base stats, your fallacies, paradoxes, etc.)
2) The ability to summon the demon to assist in combat.

For #1, this requires the player to sacrifice something (or someone). The player must break one of their core beliefs and take a hit to their stats in order to accept the boon without becoming "Inauthentic" (when a player makes a decision that goes against their pillars of principles).

For #2, this requires a much greater sacrifice, however, it's not immediate. The player must sacrifice their own soul in order to gain an exuberant amount of power very quickly. There'll be no downside until the player becomes the King's Advisor. The player will have the choice of doing what the demon asks of them. Or they can turn their back on the demon and try to get away by "duping" the demon. This will cause a number of different endings, almost all of them with terrible endings.

#### Enemies that need more explanation still:
* Cultists of Necronia
* Evil Paladins of Necronia
* Evil Clerics of Necronia
* Ex-priests of Necronia
* Priests of starting towns and other towns
* Philosophers from all around the world
* 

## What does exploration look like?
Exploration will be broken down into 3 parts for the Exploration Screen:
1) Player stats will be at the bottom of the page (ie. Health, Mana, Body, Mind, Hearth, and Experience). 

> Note: _Take a look at exploration_collapsed.png_ for reference
> Note: _Take a look at exploration_expanded.png_ to understand the functionality of the exploration screen.

## What does combat look like?

Combat is broken down into a few steps that are all done at the same time. It'll look something like this:

- Combat initiates
- Player chooses between: Body/Mind/Soul/Items
- Enemy secretly makes the same choice
- The player then selects an action:
    - Attack
    - Special Attack
    - Defend
- Again, the enemy does the same.
- The Outcome is calculated
    - If either side chose Atk/spAtk, they'll have to make an attack roll (1d20), success is dependant upon any bonuses or penalities the player has to their attack. If that calculated number is higher than the defending player's evasion, damage is calculated.
        - Damage is dependent on the character's stats and buffs, and the enemies's debuffs, but also whether they are in an advantageous position.
        - Body > Mind > Heart > Body*
            - _Will elaborate more below_
- Once the damage and (de)buffs are calculated, check the speed of each player in that moment (since debuffs can lower speed).
- Fastest player deals damage/(de)buffs first (Unless otherwise stated via equipment, etc.)
- Repeat the process until the player and the combatant have decided to agree to disagree or either player drops to 0hp

### Special Rules for Combat

- Player chooses between Body, Mind, and Heart
- Player then chooses Atk, spAtk, or Defend
- Enemy secretly makes the same choice.
- After both player and enemy make their choice, their choices are revealed and then we move to the damage phase
- Choices are compared
- Player or enemy with higher speed deals damage (and buffs/debuffs) first
- Then the player or enemy deals their damage (and buffs/debuffs)

> TODO: Create list of Fallacies, paradoxes, buffs, and debuffs
> Claude, do just ignore these for now.


> Remember: _Body > Mind > Heart > Body_

> __x__ = damage (Damage a player or enemy down to 0 HP and combat is over)

> __bdb__ = buff or debuff

> __special__ = Fallacy/Paradox testing

> __<->__ = Damage in both ways if 2nd combatant doesn't die from the atk

> __ag__ = Agreement (3 agreement points and combat comes to an "agree to disagree")

```
Format: pSelection <-> eSelection =
             playerDamageToEnemy <-> enemyDamageToPlayer>
```
#### When player has ADVANTAGE
* Atk <-> Atk     = 1x <-> 0.5x
* Atk <-> spAtk   = 1x <-> 0.25x (w/ bdb)
* Atk <-> Def     = 0.5x <-> 0.25x/0x (Fallacy Mini-game*)
* spAtk <-> Atk   = 1x (w/bdb) <-> 0.5x
* spAtk <-> spAtk = 1x (w/bdb) <-> 0.5x (w/bdb)
* spAtk <-> Def   = 0.5 (w/bdb) <-> 0.25x/0x (Fallacy Mini-game*)
* Def <-> Atk     = 0x/0.5x <-> 0x/0.25x (Fallacy Mini-game*)
* Def <-> spAtk   = 0x/0.5x <-> 0x/0.10 (Fallacy Mini-game*)
* Def <-> Def     =  0x <-> 0x (Gain 1 agreement Point)

#### When Neither player has ADVANTAGE OR DISADVANTAGE
* Atk <-> Atk     = 1x <-> 1x
* Atk <-> spAtk   = 1x <-> 0.50 (w/bdb) 
* Atk <-> Def     = 0.5x <-> 0.5x/0.25x (Fallacy Mini-game*)
* spAtk <-> Atk   = 0.5x (w/bdb) <-> 1x
* spAtk <-> spAtk = 0.5x (w/ bdb) <-> 0.5x (w/bdb)
* spAtk <-> Def   = 0x/0.50x (w/ bdb) <-> 0x/0.5x 
* Def <-> Atk     = 0x/0.50x <-> 1x
* Def <-> spAtk   = 0x/0.50x <-> 0.5x (w/bdb)
* Def <-> Def     = 0x <-> 0x (Gain 1 agreement Point)

#### When player has DISADVANTAGE
* Atk <-> Atk     = 0.5x <-> 1x
* Atk <-> spAtk   = 0.25x (w/ bdb applied after the hit) <-> 1x 
* Atk <-> Def     = 0x/0.25x/ (Fallacy Mini-game*) <-> 0.5x 
* spAtk <-> Atk   = 0.5x <-> 1x (w/bdb) 
* spAtk <-> spAtk = 0.5x (w/bdb) <-> 1x (w/bdb) 
* spAtk <-> Def   = 0x/0.25x (Fallacy Mini-game*) <-> 0.5 (w/bdb)
* Def <-> Atk     = 0x/0.25x (Fallacy Mini-game*) <-> 0x/0.5x 
* Def <-> spAtk   = 0x/0.10 (Fallacy Mini-game*) <-> 0x/0.5x
* Def <-> Def     = 0x <-> 0x (Gain 1 agreement Point)

#### Fallacy Mini-game
If either player or enemy chooses "Def", then the person who didn't say defend will use a fallacy of their choice. If the "Defensive" player can select from their list of fallacies they're able to spot, they take half, or no damage at all.

# ##############################################################
# Axiomancer Backend API Documentation

## Overview
This document provides comprehensive documentation for the Axiomancer game backend API. The backend serves as a persistent storage and state management system for a philosophical RPG where players navigate through childhood, labyrinth exploration, and adult political intrigue using logical reasoning and debate mechanics.

**Current Implementation Status**: Mock API services are implemented in TypeScript with full interfaces and error handling. Four core game systems are fully implemented with 59/233 tests passing. Real backend implementation pending.

## Base URL
```
Dev: http://localhost:3001/api  // Updated port from implementation
Prod: https://axiomancer-backend.vercel.app/

```

## Authentication
Uses JWT token-based authentication with Bearer tokens. All character and game-related endpoints require authentication headers:

```
Authorization: Bearer <token>
```

**Note**: Current mock implementation simulates authentication with localStorage tokens.

## Current Implementation Status

### Implemented API Services (Mock)
The following API services are fully implemented with TypeScript interfaces and mock responses:

**Core APIs** (`src/services/gameAPI.ts`):
- Character Management (CRUD operations)
- Game State Management (save/load, location tracking)
- Inventory and Equipment (items, equipment slots)
- Combat Statistics (fallacy knowledge, battle records)
- Exploration Progress (location history, area unlocks)
- Relationship Management (faction standings, NPC relationships)

**Quest & Story APIs** (`src/services/questAPI.ts`):
- Quest Progress (main, side, daily, hidden quests)
- Achievement System (combat, exploration, story, social categories)
- Story Milestones (chapter progress, choice consequences)

**Special Mechanics APIs** (`src/services/specialMechanicsAPI.ts`):
- Demon Contract System (soul sacrifice, stat boosts)
- Boat Building System (piece collection, completion)
- Labyrinth Progression (chamber completion, aging mechanics)

### Implemented Game Systems
- **Combat System**: D20 mechanics with Body>Mind>Heart advantage
- **Character Progression**: Experience, leveling, stat allocation, aging
- **Location System**: Starting town + forest with weather and encounters
- **Fallacy System**: Comprehensive database with combat integration
- **Equipment System**: Items with stat bonuses, rarity, level requirements

---

## User Management

### Create User
**POST** `/create-user`

Create a new user account.

**Request Body:**
```json
{
  "username": "string",
  "password": "string", 
  "email": "string"
}
```

**Response (201 - Success):**
```json
{
  "uid": "uuid-string",
  "username": "string"
}
```

**Response (200 - Username/Email Exists):**
```json
{
  "message": "Username or email already exists"
}
```

### Login User
**POST** `/login-user`

Authenticate user and get UID.

**Request Body:**
```json
{
  "username": "string",
  "password": "string"
}
```

**Response (200 - Success):**
```json
{
  "uid": "uuid-string"
}
```

**Response (200 - Invalid Credentials):**
```json
{
  "message": "Invalid credentials"
}
```

### Delete User
**POST** `/delete-user`

Delete user account and all associated data.

**Request Body:**
```json
{
  "uid": "string"
}
```

**Response (200):**
```json
{
  "message": "User deleted successfully"
}
```

---

## Character Management

### Create Character
**POST** `/create-character`

Create a new character for a user. Each user can only have one character.

**Request Body:**
```json
{
  "name": "string",
  "portrait": "elf" | "Drake" | "Arc-mage" | "Air-lord" | "Angel" | "Arch-demon",
  "age": "number"
}
```

**Portrait Bonuses (from CharacterProgression.ts):**
- **elf**: Mind +1, Heart +1 - Balanced intellectual/social approach
- **Drake**: Body +2 - Pure physical approach  
- **Arc-mage**: Mind +2 - Pure intellectual approach
- **Air-lord**: Mind +2, Heart +2 - Advanced magical/social (locked)
- **Angel**: Body +1, Mind +1, Heart +3 - Balanced divine (locked)
- **Arch-demon**: Body +3, Mind +2, Heart +1 - Powerful demonic (locked)

**Base Stats (before portrait bonuses):**
- Body: 8, Mind: 6, Heart: 5
- Health: 50 + (Body × 5), Mana: 25 + (Mind × 3)

**Response (201):**
```json
{
  "id": "char-1234567890",
  "name": "string",
  "level": 1,
  "experience": 0,
  "experienceToNext": 150,
  "age": 15,
  "stats": {
    "body": 8,
    "mind": 7,
    "heart": 6,
    "health": 65,
    "mana": 36
  },
  "detailedStats": {
    "physicalAttack": 17,
    "physicalDefense": 13,
    "accuracy": 14,
    "speed": 13,
    "mentalAttack": 15,
    "mentalDefense": 11,
    "evasion": 10,
    "perception": 12,
    "socialAttack": 13,
    "socialDefense": 10,
    "ailmentAttack": 9,
    "ailmentDefense": 10
  },
  "availableStatPoints": 0,
  "skillPoints": 0,
  "currentLocation": "starting_town",
  "unlockedLocations": ["starting_town"]
}
```

### Get Character
**GET** `/get-character?uid=string`

Retrieve character data or check if character exists.

**Response (200 - Has Character):**
```json
{
  "hasCharacter": true,
  "character": {
    // Full character object
  }
}
```

**Response (200 - No Character):**
```json
{
  "hasCharacter": false
}
```

### Update Character
**PUT** `/update-character`

Update character stats, location, or experience.

**Request Body:**
```json
{
  "uid": "string",
  "stats": {
    "body": 10,
    "mind": 12,
    "heart": 11
  },
  "location": {
    "area": "forest-north",
    "coordinates": { "x": 5, "y": 10 }
  },
  "experience": 150
}
```

**Note:** Experience updates automatically handle level-ups and stat increases.

### Delete Character
**DELETE** `/delete-character`

Delete character and all associated game data.

**Request Body:**
```json
{
  "uid": "string"
}
```

### Get Character Stats
**GET** `/character-stats?uid=string`

Get detailed character statistics including calculated values.

---

## Game State Management

### Get Game State
**GET** `/get-game-state?uid=string&saveSlot=number`

Retrieve game state for a specific save slot (1-3).

**Response (200):**
```json
{
  "uid": "string",
  "characterId": "string",
  "saveSlot": 1,
  "phase": "childhood" | "labyrinth" | "adulthood",
  "currentLocation": {
    "area": "starting-town",
    "coordinates": { "x": 0, "y": 0 }
  },
  "unlockedAreas": ["starting-town", "forest-north"],
  "questProgress": {
    "boat-building": {
      "progress": 3,
      "maxProgress": 5,
      "completed": false
    }
  },
  "storyMilestones": [
    {
      "id": "first-combat",
      "name": "First Combat",
      "description": "Completed first combat encounter",
      "timestamp": "date"
    }
  ],
  "lastSaved": "date"
}
```

### Update Game State
**POST** `/update-game-state`

Update various aspects of game state.

**Request Body:**
```json
{
  "uid": "string",
  "saveSlot": 1,
  "phase": "labyrinth",
  "currentLocation": {
    "area": "forest-north",
    "coordinates": { "x": 10, "y": 15 }
  },
  "unlockedAreas": ["starting-town", "forest-north", "labyrinth-entrance"],
  "questProgress": {
    "boat-building": {
      "progress": 5,
      "maxProgress": 5,
      "completed": true
    }
  }
}
```

### Save Game
**POST** `/save-game`

Save current game state to a specific slot.

**Request Body:**
```json
{
  "uid": "string",
  "saveSlot": 1,
  "gameState": {
    // Partial game state data to save
  }
}
```

### Load Game
**POST** `/load-game`

Load game state from a specific save slot.

**Request Body:**
```json
{
  "uid": "string",
  "saveSlot": 1
}
```

### Get Save Slots
**GET** `/get-save-slots?uid=string`

Get all save slots for a user with metadata.

**Response (200):**
```json
{
  "saveSlots": [
    {
      "slot": 1,
      "occupied": true,
      "metadata": {
        "phase": "childhood",
        "lastSaved": "date",
        "currentLocation": {
          "area": "starting-town",
          "coordinates": { "x": 0, "y": 0 }
        }
      }
    },
    {
      "slot": 2,
      "occupied": false
    },
    {
      "slot": 3,
      "occupied": false
    }
  ]
}
```

### Update Story Milestone
**POST** `/update-story-milestone`

Record a new story milestone.

**Request Body:**
```json
{
  "uid": "string",
  "saveSlot": 1,
  "milestone": {
    "id": "first-demon-encounter",
    "name": "First Demon Encounter", 
    "description": "Met first demon after dying in the city"
  }
}
```

---

## Inventory & Equipment System

### Get Inventory
**GET** `/get-inventory?uid=string`

Get complete inventory including items, equipment, and gold.

**Response (200):**
```json
{
  "uid": "string",
  "items": [
    {
      "itemId": "health-potion",
      "quantity": 3,
      "equipped": false
    },
    {
      "itemId": "iron-sword", 
      "quantity": 1,
      "equipped": true,
      "equipmentSlot": "weapon"
    }
  ],
  "equipment": {
    "weapon": "iron-sword",
    "armor": null,
    "accessory1": null,
    "accessory2": null
  },
  "gold": 150,
  "maxSlots": 20,
  "boatProgress": {
    "piecesCollected": ["boat-hull", "boat-sail"],
    "totalPieces": 5,
    "completed": false
  }
}
```

### Add Item
**POST** `/add-item`

Add items to inventory. Stackable items will stack, unique items require inventory space.

**Request Body:**
```json
{
  "uid": "string",
  "itemId": "health-potion",
  "quantity": 2
}
```

### Remove Item
**POST** `/remove-item`

Remove items from inventory.

**Request Body:**
```json
{
  "uid": "string",
  "itemId": "health-potion", 
  "quantity": 1
}
```

### Equip Item
**POST** `/equip-item`

Equip item to appropriate slot. Unequips current item in slot.

**Request Body:**
```json
{
  "uid": "string",
  "itemId": "iron-sword",
  "slot": "weapon" | "armor" | "accessory1" | "accessory2"
}
```

**Response includes updated character stats with equipment bonuses.**

### Unequip Item
**POST** `/unequip-item`

Unequip item from slot and return to inventory.

**Request Body:**
```json
{
  "uid": "string",
  "slot": "weapon"
}
```

### Use Item
**POST** `/use-item`

Consume a consumable item and apply its effects.

**Request Body:**
```json
{
  "uid": "string",
  "itemId": "health-potion",
  "quantity": 1
}
```

**Response includes updated character stats after consumption.**

### Get Equipment
**GET** `/get-equipment?uid=string`

Get currently equipped items and their stat bonuses.

### Update Gold
**POST** `/update-gold`

Add or spend gold.

**Request Body:**
```json
{
  "uid": "string",
  "amount": 100,
  "operation": "add" | "spend"
}
```

### Get Boat Progress
**GET** `/get-boat-progress?uid=string`

Get boat building progress during childhood phase.

### Craft Boat
**POST** `/craft-boat`

Craft boat when all pieces are collected. Unlocks sea travel.

**Request Body:**
```json
{
  "uid": "string"
}
```

---

## Combat System

### Initiate Combat
**POST** `/initiate-combat`

Start combat with an enemy in a specific location.

**Request Body:**
```json
{
  "uid": "string",
  "enemyId": "forest-spirit-1",
  "location": "forest-north"
}
```

**Response (200):**
```json
{
  "id": "combat-session-123",
  "uid": "string",
  "enemyId": "forest-spirit-1",
  "location": "forest-north",
  "playerHp": 100,
  "playerMp": 50,
  "enemyHp": 80,
  "round": 1,
  "status": "active",
  "log": ["Combat initiated"],
  "createdAt": "date"
}
```

### Combat Action
**POST** `/combat-action`

Execute a combat action using the implemented D20 system.

**Request Body:**
```json
{
  "uid": "string",
  "combatId": "combat-session-123",
  "action": {
    "type": "Body" | "Mind" | "Heart",
    "action": "Attack" | "SpecialAttack" | "Defend"
  }
}
```

**D20 Combat System (Implemented):**
- **Hit Calculation**: 1d20 + accuracy vs evasion
- **Damage System**: 
  - Normal: 1d6 damage
  - Advantage: 1d8 damage  
  - Disadvantage: 1d4 damage
  - Defending: 1d4 damage (reduced)
- **Advantage Rules**: Body > Mind > Heart > Body (rock-paper-scissors)
- **Agreement System**: Both defend = +1 agreement point (3 = peaceful victory)
- **Fallacy Defense**: Defending triggers fallacy mini-game for damage reduction

### Use Special Attack
**POST** `/use-special-attack`

Use fallacy or paradox attacks that consume MP.

**Request Body:**
```json
{
  "uid": "string",
  "combatId": "combat-session-123",
  "attackId": "strawman-fallacy",
  "choice": {
    "type": "mind",
    "action": "special-attack"
  }
}
```

### Fallacy Challenge
**POST** `/fallacy-challenge`

Present fallacy identification mini-game when defending (auto-triggered by combat system).

**Response (from FallacyParadoxSystem.ts):**
```json
{
  "fallacyName": "Zeno's Paradox",
  "description": "The famous paradox questioning the possibility of motion itself",
  "question": "Your opponent argues: 'To reach me, you must first travel half the distance. But to travel half, you must first travel a quarter, and so on infinitely. Therefore, you can never reach me.' What resolves this paradox?",
  "options": [
    "Motion requires time, not just space",
    "Infinite divisions can still sum to a finite distance", 
    "The paradox ignores quantum mechanics",
    "Mathematics cannot describe reality"
  ],
  "correctAnswer": 1
}
```

**Implemented Fallacies:**
- **Paradoxes**: Zeno's Paradox, Ship of Theseus, Liar's Paradox, Achilles and the Tortoise
- **Logical Fallacies**: Ad Hominem, Straw Man, False Dichotomy
- **Rhetorical Fallacies**: Appeal to Emotion, Bandwagon Fallacy
- **Total**: 9 fallacies/paradoxes with full combat integration

**Defense Result:**
- Correct: 25% damage taken (75% reduction)
- Incorrect: 100% damage taken (no reduction)

### Demon Contract
**POST** `/demon-contract`

Handle demon contract offers after player death in empire city.

**Request Body:**
```json
{
  "uid": "string", 
  "demonName": "Belphegor",
  "contractType": "stat-boost" | "summoning",
  "accepted": true,
  "terms": {
    "sacrifice": "core-belief-compassion",
    "benefit": { "body": 3 }
  }
}
```

**Contract Types:**
- **stat-boost**: Immediate stat increase for sacrificing core belief
- **summoning**: Soul sacrifice for demon summoning ability (affects endings)

### Summon Demon
**POST** `/summon-demon`

Summon contracted demon in combat (requires soul sacrifice).

**Request Body:**
```json
{
  "uid": "string",
  "combatId": "combat-session-123", 
  "demonName": "Belphegor"
}
```

### Get Combat Statistics
**GET** `/combat-statistics?uid=string`

Get player's combat performance statistics.

### Get Available Special Attacks
**GET** `/available-special-attacks?uid=string`

Get unlocked special attacks with MP costs and unlock requirements.

---

## Exploration System

### Get Location
**GET** `/get-location?uid=string`

Get current location details including description and available actions.

**Response (200) - Implemented Locations:**
```json
{
  "area": "starting_town",
  "coordinates": { "x": 0, "y": 0 },
  "name": "Seafarer's Haven",
  "description": "A humble fishing village nestled between river and sea. Salt-stained wooden docks extend into dark waters, while weathered fishermen mend nets that have seen too many storms. The air carries the scent of brine and decay.",
  "type": "town",
  "properties": {
    "canRest": true,
    "hasShops": true, 
    "dangerLevel": 0,
    "weatherAffected": false
  },
  "encounters": {
    "combat": [],
    "events": ["village_gossip", "merchant_arrival", "fishing_boat_returns"],
    "npcs": ["village_elder", "fisherman", "merchant", "tavern_keeper"]
  },
  "resources": ["fish", "seaweed", "driftwood"]
}
```

**Northern Forest Location:**
```json
{
  "area": "northern_forest",
  "name": "Whispering Woods", 
  "description": "Ancient trees stretch endlessly before you, their gnarled branches creating a canopy so thick that daylight becomes a scarce commodity. Shadows move where no wind blows, and the very air seems thick with forgotten secrets.",
  "type": "wilderness",
  "properties": {
    "canRest": true,
    "hasShops": false,
    "dangerLevel": 3,
    "weatherAffected": true
  },
  "encounters": {
    "combat": ["forest_spirit", "wild_animal", "bandit_scout"],
    "events": ["ancient_ruin", "mysterious_clearing", "lost_traveler"],
    "npcs": ["hermit_philosopher", "traveling_merchant", "legendary_elk"]
  },
  "resources": ["herbs", "mushrooms", "wood", "berries"]
}
```

### Move to Location
**POST** `/move-to-location`

Move player to a new location (must be unlocked).

**Request Body:**
```json
{
  "uid": "string",
  "targetLocation": {
    "area": "forest-north",
    "coordinates": { "x": 5, "y": 10 }
  }
}
```

### Get Available Areas
**GET** `/get-available-areas?uid=string`

Get all areas with unlock status and descriptions.

**Response (200):**
```json
{
  "areas": [
    {
      "id": "starting-town",
      "name": "Harbor Town", 
      "unlocked": true,
      "description": "Your peaceful starting location"
    },
    {
      "id": "forest-north",
      "name": "Northern Forest",
      "unlocked": true, 
      "description": "A mysterious forest with ancient spirits"
    },
    {
      "id": "labyrinth-entrance",
      "name": "Labyrinth Entrance",
      "unlocked": false,
      "description": "The legendary labyrinth doors (Requires boat)"
    },
    {
      "id": "empire-city", 
      "name": "Empire City",
      "unlocked": false,
      "description": "The advanced civilization beyond the labyrinth"
    },
    {
      "id": "necronia",
      "name": "Necronia", 
      "unlocked": false,
      "description": "The dark city of cultists and demons (Special unlock required)"
    }
  ]
}
```

---

## Game Progression Overview

### Phase 1: Childhood (Boat Building)
- **Location**: Starting town and surrounding areas
- **Goal**: Collect boat pieces to build transportation
- **Mechanics**: Simple exploration, NPC interactions, basic combat with forest spirits
- **Key Quest**: Boat building (requires 5 pieces: hull, sail, rudder, mast, anchor)

### Phase 2: Labyrinth (Age Progression)  
- **Location**: Inside the massive labyrinth
- **Goal**: Navigate chambers and reach the empire
- **Mechanics**: Each chamber ages the character 1 year, puzzle solving, mythical creature combat
- **Progression**: Childhood → Adulthood transformation

### Phase 3: Adulthood (Empire Politics)
- **Location**: Empire city with warring factions
- **Goal**: Become the King's advisor
- **Mechanics**: Advanced philosophical combat, faction alignment, demon contracts
- **Factions**: Based on philosophical schools (Existentialists, Theists, etc.)

### Combat System Details
- **Body/Mind/Heart**: Rock-paper-scissors system with advantages
- **Special Attacks**: Fallacies and paradoxes learned throughout the game
- **Fallacy Mini-game**: Identify logical fallacies to reduce damage when defending
- **Demon Contracts**: Powerful but dangerous - affect game endings
- **Agreement System**: Alternative to violence, gain agreement points instead of dealing damage

### Ending Variations
- **Pure Path**: No demon contracts, achieved through skill and alignment
- **Demon Puppet**: Fully corrupted by demon contracts
- **Balanced Approach**: Strategic demon use with maintained independence
- **Faction Loyalty**: Endings based on chosen philosophical faction

---

## Error Handling

All endpoints return appropriate HTTP status codes:
- **200**: Success
- **201**: Created successfully  
- **400**: Bad request (validation error)
- **403**: Forbidden (unauthorized access)
- **404**: Resource not found
- **409**: Conflict (duplicate resource)
- **500**: Internal server error

Error responses include descriptive messages:
```json
{
  "message": "Descriptive error message"
}
```

---

## Database Models

### Character Stats Calculation (Implemented)
- **Base Health** = 50 + (Body × 5)
- **Base Mana** = 25 + (Mind × 3)
- **Experience Required** = 100 × 1.5^(level-1) [scaling formula]
- **Level Up Rewards** = +3 stat points, +1 skill point, health/mana increase
- **Detailed Stats** = Calculated from base stats with age multipliers

**Age-Based Stat Multipliers:**
- Youth (≤16): Body ×1.1, Mind ×0.8, Heart ×0.7
- Young Adult (17-25): Body ×1.0, Mind ×1.0, Heart ×1.0  
- Adult (26-40): Body ×0.9, Mind ×1.2, Heart ×1.1
- Middle Age (41-60): Body ×0.8, Mind ×1.3, Heart ×1.2
- Elder (60+): Body ×0.6, Mind ×1.4, Heart ×1.3

**Detailed Stat Formulas:**
- Physical Attack = (Body × 1.5 + 5) × age_multiplier
- Mental Attack = (Mind × 1.5 + 5) × age_multiplier  
- Social Attack = (Heart × 1.5 + 5) × age_multiplier
- [Plus accuracy, evasion, speed, defense calculations]

### Game State Validation
- **Save Slots**: 1-3 per user
- **Area Access**: Validated against unlocked areas
- **Phase Progression**: childhood → labyrinth → adulthood

### Inventory Constraints
- **Max Slots**: 20 items (configurable)
- **Stackable Items**: Potions, herbs, materials
- **Equipment Slots**: weapon, armor, accessory1, accessory2
- **Gold**: Non-negative integer

## Implementation Status Summary

### ✅ Fully Implemented (Mock APIs + Game Systems)
- **Character Management**: Creation, progression, stat allocation, aging system
- **Combat System**: D20 mechanics, fallacy challenges, agreement points  
- **Location System**: Starting town + forest with encounters and weather
- **Fallacy System**: 9 fallacies/paradoxes with combat integration
- **Equipment System**: Items, stat bonuses, rarity levels, set bonuses
- **API Structure**: Complete TypeScript interfaces with error handling
- **System API**: Status checking, health monitoring, and ping functionality

### 🚧 Partially Implemented (API Structure Only)
- **Inventory Management**: Interface defined, basic functionality needed
- **Quest System**: API structure ready, quest content needs expansion
- **Game State**: Save/load structure ready, persistence layer needed
- **Demon Contracts**: API designed, integration with story needed

### ⏳ Planned Implementation
- **Real Backend**: Replace mock APIs with actual server implementation
- **Database Layer**: MongoDB integration for persistent storage  
- **Advanced Locations**: Labyrinth, Empire City, additional areas
- **Skill Trees**: Body/Mind/Heart specialization paths
- **Crafting System**: Item creation and improvement mechanics

### Test Coverage
- **59/233 tests passing** (25% coverage increase)
- **4/13 test suites** fully implemented and tested
- **174 tests skipped, 9 test suites skipped**
- Core game mechanics validated and working

This comprehensive API structure supports the current Axiomancer implementation with robust mock services, ready for backend integration and expansion into the full game experience.
